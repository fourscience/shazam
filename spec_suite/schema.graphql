directive @private on FIELD_DEFINITION
directive @deprecated(reason: String) on FIELD_DEFINITION | ENUM_VALUE
directive @_upper on FIELD | FRAGMENT_SPREAD | INLINE_FRAGMENT

schema {
  query: Query
  mutation: Mutation
  subscription: Subscription
}

enum Role {
  USER
  ADMIN
  MODERATOR
}

enum Reaction {
  LIKE
  LOVE
  WOW
  ANGRY
  SAD
}

interface Node {
  id: ID!
}

interface Person {
  name: String!
  role: Role
}

type User implements Node & Person {
  id: ID!
  name: String!
  role: Role
  bio: String
  posts: [Post!]!
  favoritePost: Post
  friends: [User!]!
  reactions: [Reaction!]!
  metadata: Metadata
}

type Metadata {
  isPublished: Boolean!
  rating: Float
  createdAt: String
}

input MetadataInput {
  isPublished: Boolean
  rating: Float
}

type Stats {
  views: Int!
  likes: Int!
  reactions: [Reaction!]!
}

type Comment implements Node {
  id: ID!
  body: String!
  author: User!
  replies: [Comment!]!
}

type Post implements Node {
  id: ID!
  title: String!
  content: String
  author: User!
  tags: [String!]!
  metadata: Metadata
  stats: Stats!
  comments: [Comment!]!
  likedBy: [User!]!
}

input PostInput {
  title: String!
  content: String
  tags: [String!]
  metadata: MetadataInput
}

union Activity = Post | Comment
union SearchResult = User | Post | Comment

type AuthPayload {
  token: String!
  user: User!
}

type LikeToggleResult {
  success: Boolean!
  target: Node
}

type Query {
  user(id: ID!): User
  search(term: String!): [SearchResult!]!
  posts(limit: Int = 10): [Post!]!
  feed: [Activity!]!
}

type Mutation {
  createPost(input: PostInput!): Post!
  toggleLike(id: ID!, on: Boolean! = true): LikeToggleResult!
  login(username: String!, password: String!): AuthPayload!
}

type Subscription {
  postAdded: Post!
  activity: Activity!
}
